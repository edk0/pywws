<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <title>
      Software for WeatherStations: Plot.py
    </title>
  </head>
  <body>
    <h1>
      <a href="index.html">Python software for USB Wireless WeatherStations</a>
    </h1>
    <h2>
      <a href="auto/Plot.html">Plot.py</a> -- plots graph using an XML template
    </h2>
    <p>
      Like <a href="Template.html">Template.py</a> this is one of the more difficult to use modules in the weather station software collection. It plots a graph (or set of graphs) of weather data. Almost everything about the graph is controlled by an XML file. I refer to these files as templates, but they aren't templates in the same sense as Template.py uses to create text files.
    </p>
    <p>
      Before writing your own graph template files, it might be useful to look at some of the examples in the <a href="../example_graph_templates/">example_graph_templates directory</a>. If (like I was) you are unfamiliar with XML, I suggest reading the <a href="http://www.w3schools.com/xml/">W3 Schools XML tutorial</a>.
    </p>
    <h2>
      XML graph file syntax
    </h2>
    <p>
      Here is the simplest useful graph template. It plots the external temperature for the last 24 hours.
    </p>
<pre>
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;graph&gt;
  &lt;plot&gt;
    &lt;subplot&gt;
      &lt;title&gt;Temperature (&deg;C)&lt;/title&gt;
      &lt;ycalc&gt;data['temp_out']&lt;/ycalc&gt;
    &lt;/subplot&gt;
  &lt;/plot&gt;
&lt;/graph&gt;
</pre>
    <p>
      In this example, the root element <code>graph</code> has one <code>plot</code> element, which has one <code>subplot</code> element. The <code>subplot</code> element contains a <code>title</code> element and a <code>ycalc</code> element. To plot more data on the same set of axes (for example dew point and temperature), we can add more <code>subplot</code> elements. To plot more than one set of axes (for example wind speed is measured in different units from temperature) in the same file we can add more <code>plot</code> elements.
    </p>
    <p>
	The complete element hierarchy is shown below. Each element name links to a full description of that element.
    </p>
    <a name="list"><ul></a>
      <li>
        <a href="#graph">graph</a>
        <ul>
          <li>
            <a href="#plot">plot</a>
			<ul>
			  <li>
                <a href="#subplot">subplot</a>
				<ul>
				  <li>
                    <a href="#xcalc">xcalc</a>
				  </li>
				  <li>
                    <a href="#ycalc">ycalc</a>
				  </li>
				  <li>
                    <a href="#style">style</a>
				  </li>
				  <li>
                    <a href="#colour">colour</a>
				  </li>
				  <li>
                    <a href="#title">title</a>
				  </li>
				</ul>
			  </li>
			  <li>
                <a href="#yrange">yrange</a>
			  </li>
			  <li>
                <a href="#source">source</a>
			  </li>
			  <li>
                <a href="#boxwidth">boxwidth</a>
			  </li>
			</ul>
          </li>
          <li>
            <a href="#start">start</a>
          </li>
          <li>
            <a href="#stop">stop</a>
          </li>
          <li>
            <a href="#duration">duration</a>
          </li>
          <li>
            <a href="#size">size</a>
          </li>
          <li>
            <a href="#xformat">xformat</a>
          </li>
          <li>
            <a href="#xtics">xtics</a>
          </li>
        </ul>
      </li>
    </ul>
    <h3>
      <a href="#list" name="graph">graph</a>
    </h3>
    <p>
      This is the root element of the graph XML file. It does not have to be called "graph", but there must be exactly one root element.
    </p>
    <h3>
      <a href="#list" name="plot">plot</a>
    </h3>
    <p>
      Every graph element should contain at least one plot element. A separate graph is drawn for each plot element, but all share the same X axis.
    </p>
    <h3>
      <a href="#list" name="start">start</a>
    </h3>
    <p>
	This element sets the date &amp; time of the left hand side of the graph. It is used in the constructor of a Python <a href="auto/datetime.html#datetime">datetime</a> object. For example, to start the graph at noon (local time) on Christmas day: <code>&lt;start&gt;year=2008, month=12, day=25, hour=12&lt;/start&gt;</code>. The default value is <code>(stop - duration)</code>.
    </p>
    <h3>
      <a href="#list" name="stop">stop</a>
    </h3>
    <p>
	This element sets the date &amp; time of the right hand side of the graph. It is used in the constructor of a Python <a href="auto/datetime.html#datetime">datetime</a> object. For example, to end the graph at 10 am (local time) on new year's day: <code>&lt;stop&gt;year=2009, month=1, day=1, hour=10&lt;/stop&gt;</code>. The default value is <code>(start + duration)</code>, unless <code>start</code> is not defined in which case the timestamp of the latest weather station hourly reading is used.
    </p>
    <h3>
      <a href="#list" name="duration">duration</a>
    </h3>
    <p>
	This element sets the extent of the X axis of the graph, unless both <code>start</code> and <code>stop</code> are defined. It is used in the constructor of a Python <a href="auto/datetime.html#timedelta">timedelta</a> object. For example, to plot one week: <code>&lt;duration&gt;weeks=1&lt;/duration&gt;</code>. The default value is <code>hours=24</code>.
    </p>
    <h3>
      <a href="#list" name="size">size</a>
    </h3>
    <h3>
      <a href="#list" name="xformat">xformat</a>
    </h3>
    <h3>
      <a href="#list" name="xtics">xtics</a>
    </h3>
    <h3>
      <a href="#list" name="subplot">subplot</a>
    </h3>
    <p>
      Every plot element should contain at least one subplot element. A separate trace is drawn for each subplot element, but all share the same X and Y axes.
    </p>
    <h3>
      <a href="#list" name="yrange">yrange</a>
    </h3>
    <h3>
      <a href="#list" name="source">source</a>
    </h3>
    <h3>
      <a href="#list" name="boxwidth">boxwidth</a>
    </h3>
    <h3>
      <a href="#list" name="xcalc">xcalc</a>
    </h3>
    <h3>
      <a href="#list" name="ycalc">ycalc</a>
    </h3>
    <h3>
      <a href="#list" name="style">style</a>
    </h3>
    <h3>
      <a href="#list" name="colour">colour</a>
    </h3>
    <h3>
      <a href="#list" name="title">title</a>
    </h3>
    <hr>
    <p>
      <a href="http://code.google.com/p/pywws/"><i>Python software for USB Wireless WeatherStations</i></a> &copy; <a href="http://www.jim-easterbrook.me.uk/">Jim Easterbrook</a>.
    </p>
  </body>
</html>

